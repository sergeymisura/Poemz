var app={}(function($){var _controllers={};var _services={};var _servicesFactory=function($element){var services={};$.each(_services,function(name,factory){services[name]=factory($element,services)});return services};$.extend(app,{controller:function(name,controller){_controllers[name]=controller},service:function(name,service){_services[name]=service},bindControllers:function($scope){$scope.find("[data-controller]").each(function(idx,element){var $element=$(element);var controller=_controllers[$element.attr("data-controller")]||
$.noop;element.templates={};app.bindTemplates($element,$element);element.controller=controller($element,_servicesFactory($element));if(typeof element.controller.init!=="undefined")element.controller.init()})},bindTemplates:function($scope,$controllerElement){if(typeof $controllerElement=="undefined")$controllerElement=$scope.attr("data-controller")?$scope:$scope.parents("data-controller");$scope.find("[data-template]").each(function(idx,template){var $placeholder=$("<div />").addClass($(template).attr("data-template")+
"-placeholder");$(template).replaceWith($placeholder);$controllerElement.get(0).templates[$(template).attr("data-template")]={template:$("<div />").append($(template)),placeholder:$placeholder}})}});$(document).ready(function(){$("[data-toggle='tooltip']").tooltip();app.bindControllers($("body"))})})(jQuery);(function(){app.service("api",function($element,services){return{get:function(uri,data){if(typeof data=="undefined")data={};var result=services.dereferred.create();$.ajax(app.config.baseUrl+"/api/"+uri,{data:data,success:result.successCallback(),error:result.errorCallback()});return result},post:function(uri,data){if(typeof data=="undefined")data={};var result=services.dereferred.create();$.ajax(app.config.baseUrl+"/api/"+uri,{type:"post",contentType:"application/json",dataType:"json",data:JSON.stringify(data),
success:result.successCallback(),error:result.errorCallback()});return result},widget:function($container,uri){var result=services.dereferred.create();$container.load(app.config.baseUrl+uri,result.successCallback());return result}}})})(jQuery,app);(function(){app.service("bind",function($element,services){return function(map){$.each(map,function(selector,value){$.each(value,function(event,method){$element.on(event,selector,function(ev){var $this=$(this);var callable=typeof method=="string"?$element[0].controller[method]:method;return $.proxy(callable,$element[0].controller)($this,services.rendering.container($this).data("data"),ev)})})})}})})(jQuery,app);(function(){app.service("dereferred",function($element){return{create:function(){return{success:function(callback,context){this._success=$.proxy(callback,context);return this},error:function(callback,context){this._error=$.proxy(callback,context);return this},before:function(callback,context){$.proxy(callback,context)();return this},after:function(callback,context){this._after=$.proxy(callback,context);return this},successCallback:function(){return $.proxy(function(){(this._after||$.noop).apply(null,
arguments);(this._success||$.noop).apply(null,arguments)},this)},errorCallback:function(){return $.proxy(function(){(this._after||$.noop).apply(null,arguments);(this._error||$.noop).apply(null,arguments)},this)}}}}})})(jQuery,app);(function(){app.service("rendering",function($element){var _renderOne=function(template,data,filters){var $new=template.template.tmpl($.extend(data,filters)).addClass("rendered");$new.data("data",data);$new.data("template",template);$new.data("filters",filters);app.bindControllers($new);app.bindTemplates($new,$element);return $new};return{render:function(name,data,filters){filters=filters||{};var template=$element[0].templates[name];var $placeholder=$element.find("."+name+"-placeholder");if(template){$placeholder.html("");
if(data.constructor===Array)$.each(data,function(idx,item){$placeholder.append(_renderOne(template,item,filters))});else $placeholder.append(_renderOne(template,data,filters));return $placeholder.children()}},refresh:function($part,data){$part=this.container($part);if(typeof data=="undefined")data=$part.data("data");var template=$part.data("template");var filters=$part.data("filters");var $new=_renderOne(template,data,filters);$part.replaceWith($new);return $new},container:function($el){return $el.hasClass("rendered")?
$el:$el.parents(".rendered")}}})})(jQuery,app);(function(){app.service("validation",function($element,services){var _validationFunctions={value:{test:function($source){return $source.val()!=""},message:"This field cannot be empty."},email:{test:function($source){return/^[\\+0-9a-zA-Z\\-\\.\\_]+@([0-9a-zA-Z\\-]+\\.)+[0-9a-zA-Z]+$/.test($source.val())},message:"Please enter a valid email address"},integer:{test:function($source){return/^[0-9]+$/.test($source.val())},message:"Please enter an integer value"},decimal:{test:function($source){return/^[0-9]*(\.)?[0-9]+$/.test($source.val())},
message:"Please enter a numeric value"}};var _test=function($source){var type=$source.data("required");return true};var _validate=function($source,message){var $parent=$source.parents(".control-group, .validation-group");if($source.is(":visible")&&!$source.prop("disabled")){var type=$source.data("required");var rule=_validationFunctions[type];if(rule)if(!rule.test($source)){$source.addClass("invalid");if(message)$parent.find(".errors").html("").append($("<label/>").html(rule.message).addClass("label").addClass("label-important"));
return false}}$source.removeClass("invalid");$parent.find(".errors").html("");return true};services.bind({"input[data-required]":{focus:function($source){_validate($source,false)},keyup:function($source){_validate($source,false)},blur:function($source){_validate($source,true)}},"select[data-required]":{change:function($source){_validate($source,true)},focus:function($source){_validate($source,false)}}});return validation=function($form){var result=true;$form.find("[data-required]").each(function(idx,
element){result=_validate($(element),true)&&result});return result}})})(jQuery,app);
